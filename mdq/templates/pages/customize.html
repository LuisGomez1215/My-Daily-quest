{% extends "layouts/master.html" %}
{% block content %}
{% load static %}

<body class="gamertext" style="background-image: url('{% static "backgrounds/background.png" %}')">
    <div class="container">
        <div class="d-flex justify-content-center align-items-center petscreen position-relative">
            <img class="h100 w100 img-fluid" src="{% static "backgrounds/boxpet.png" %}">
            <div class="pet-overlay position-absolute top-50 bottom-50 start-50 translate-middle">
                <div class="pet-wrapper position-relative d-inline-block">
                    <img class="img-fluid spot-offset" src="{% static 'icons/PETSPOT.png' %}">
                    <img class="pet img-fluid position-absolute top-50 start-50 translate-middle"
                    src="{{ pet.species.pet_avatar.url }}"
                    alt="{{ pet.name }}">
                </div>
            </div>
        </div>
    </div>
    <div class="container py-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <input type="text" class="form-control me-2" placeholder="Search items..." style="max-width: 70%;">
            <select class="form-select" style="max-width: 25%;">
                <option>All</option>
                <option>Cosmetics</option>
                <option>Consumables</option>
                <option>Backgrounds</option>
            </select>
        </div>
        <div class="row g-3 text-center">
        {% for closet in cosmetics %}
                {% for clo_item in closet.closetitem_set.all %}
                <div class="col-3">
                    <form method="post" action="{% url 'customize-equip' clo_item.id %}" class="equip-form">
                        {% csrf_token %}
                        <div class="inventory-slot d-flex flex-column justify-content-center align-items-center clickable-slot">
                            <img src="{{ clo_item.cosmetic.icon.url }}"
                                alt="{{ clo_item.cosmetic.name }}"
                                class="inventory-image">
                        </div>
                        <p class="small mb-0" style="color:black;">{{ clo_item.cosmetic.name }}</p>
                        {% if clo_item.equipped %}
                        <span class="badge bg-success mt-1 small">{{ clo_item.cosmetic.slot }}</span>
                        {% endif %}
                    </form>
                </div>
                {% endfor %}
            {% endfor %}
            {% for inventory in items %}
                {% for inv_item in inventory.inventoryitem_set.all %}
                <div class="col-3">
                    <div class="inventory-slot d-flex justify-content-center align-items-center">
                        <img src="{{ inv_item.consumable.icon.url }}" alt="{{ inv_item.consumable.name }}" class="inventory-image">
                    </div>
                    <div class="small">
                        <p style="color:black;">{{ inv_item.consumable.name  }}</p>
                        <p style="color:black;">x{{ inv_item.quantity }}</p>
                    </div>
                </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>
</body>
<script>
    document.querySelectorAll(".clickable-slot").forEach(slot => {
        slot.addEventListener("click", function() {
            this.closest(".equip-form").submit();
        });
    });
</script>
{% endblock %}
